# Settings for a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

# Specifies the version of the App Hosting manifest.
version: 1

# Defines the services that make up your application.
services:
  # The frontend service, our Next.js application.
  - id: frontend
    # Specifies the location of the Next.js application.
    source: .
    # The 'run' section specifies the command to start the server.
    run: npm run build && npm run start

  # The backend service, our Python application.
  - id: backend
    # Specifies the location of the Python application.
    source: backend_code
    # The 'run' section specifies the command to start the server.
    # Gunicorn is a popular Python WSGI HTTP Server.
    run: gunicorn main:app --bind 0.0.0.0:$PORT

# Defines how incoming requests are routed to your services.
routing:
  # This rule directs all requests starting with /api to the backend service.
  - path: /api/.*
    service: backend

  # This is the default rule. It directs all other requests to the frontend service.
  - path: /.*
    service: frontend
