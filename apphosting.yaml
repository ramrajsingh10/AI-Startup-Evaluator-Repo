# The apphosting.yaml defines the configuration for your App Hosting backend.
# You can learn more about this file here: https://firebase.google.com/docs/hosting/app-hosting/apphosting-yaml
# This file is required for App Hosting to build and run your app.

# Specifies the version of the App Hosting platform.
version: 1

# Defines the services that make up your application.
services:
  # The frontend service, our Next.js application.
  - id: frontend
    # Specifies the location of the Next.js application.
    source: .
    # The 'run' command specifies how to start the server. The build is handled automatically.
    run: npm run start
    # Environment variables needed for the build and runtime of the frontend.
    env:
      - variable: NEXT_PUBLIC_FIREBASE_API_KEY
        value: "AIzaSyDYssyhTe4mi4LqTLsRan5ynea2We9h7Oo"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
        value: "ai-startup-evaluator-472309.firebaseapp.com"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
        value: "ai-startup-evaluator-472309"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
        value: "ai-startup-evaluator-472309.firebasestorage.app"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
        value: "106488605175"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_APP_ID
        value: "1:106488605175:web:21a11c165d5f536798e6f2"
        availability: [BUILD, RUNTIME]
      - variable: NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID
        value: "G-RF1ETWRCSH"
        availability: [BUILD, RUNTIME]

# The backend service, our FastAPI application.
  - id: backend
    # Specifies the location of the FastAPI application.
    source: backend_code
    # Specifies the runtime for the backend service.
    runtime: python
    # The 'run' command specifies how to start the server. The build is handled automatically.
    run: gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app
    # Environment variables needed for the build and runtime of the backend.
    env:
      - variable: FIREBASE_PROJECT_ID
        value: "ai-startup-evaluator-472309"
        availability: [BUILD, RUNTIME]

# Defines the build process for your application.
build:
  # Specifies the version of the buildpacks to use.
  builder: "22"
